# Chinese Learning App

A web application for learning Chinese characters through interactive quizzes with user account management.

## Features

- **User Accounts**: Simple username/password login - each user has their own isolated data
- **Character Upload**: Upload Chinese characters via CSV file or add them manually
- **Recognition Quiz**: See a character and select the correct pinyin from multiple choices
- **Reverse Quiz**: See the meaning and type the correct character
- **Multiple Choice Quiz**: See a character and select the correct meaning
- **Progress Tracking**: Track your learning progress over time

## Prerequisites

- [Node.js](https://nodejs.org/) (version 18 or higher)
- npm (comes with Node.js)

## Getting Started

### 1. Install Dependencies

Open a terminal in the project folder and run:

```bash
npm install
```

### 2. Start the Application

```bash
npm run dev
```

The application will start and display:

```
▲ Next.js 16.0.3 (Turbopack)
- Local:         http://localhost:3000
```

Open your browser and go to **http://localhost:3000**

### 3. Create an Account or Login

When you first visit the app, you'll see a login page:

**To register a new account:**
1. Click "Create one" 
2. Enter a username (2-20 characters: letters, numbers, underscores)
3. Enter a password (minimum 4 characters)
4. Confirm your password
5. Click "Register"

**To login with an existing account:**
1. Enter your username
2. Enter your password
3. Click "Login"

Your data is stored separately from other users and persists across sessions.

### 4. Stop the Application

Press `Ctrl + C` in the terminal to stop the server.

## CSV File Format

To upload characters, create a CSV file with the following format:

```
Character,Pinyin,Meaning,Phrase
备,bèi,prepare,准备
文,wén,writing,文字
中,zhōng,middle,中国
```

| Column | Description | Example |
|--------|-------------|---------|
| Character | The Chinese character | 备 |
| Pinyin | The correct pinyin with tone marks | bèi |
| Meaning | English meaning | prepare |
| Phrase | A word/phrase (词组) containing the character | 准备 |

The `Phrase` column is used in the Writing Quiz to provide context hints.

## Quiz Types

### Read Quiz
- Shows a Chinese character and its meaning
- Select the correct pinyin from 4 options (correct + 3 random pinyin from other characters)

### Writing Quiz
- Shows the phrase (词组) with the target character replaced by its pinyin as a hint
- Example: For character 备 (bèi) with phrase 准备, it shows "准(bèi)"
- Draw/write the character using touch screen, stylus, or mouse
- Self-assess by comparing your drawing to the correct character

### Multiple Choice Quiz
- Shows a Chinese character
- Select the correct meaning from 4 options

## Architecture

### Data Storage

This application uses **CSV files** stored on the server for persistent data storage. Each user has their own data directory.

| Data | File Location | Description |
|------|---------------|-------------|
| Users | `data/users.csv` | User credentials (username + hashed password) |
| Characters | `data/users/{username}/characters.csv` | User's uploaded Chinese characters |
| Progress | `data/users/{username}/progress.csv` | User's quiz statistics |

**Benefits:**
- Each user has completely separate data
- Data persists across all browsers and devices
- Data survives browser cache clearing
- Easy to backup or edit data files directly

**File Format:**

`users.csv`:
```
username,passwordHash
john,a1b2c3d4e5f6...
```

`characters.csv`:
```
id,character,pinyin,meaning,phrase
1234567890,备,bèi,prepare,准备
```

`progress.csv`:
```
characterId,correct,incorrect
1234567890,5,2
```

### Quiz Options Generation

Quiz options are **NOT generated by AI**. They come directly from your uploaded data:

| Quiz Type | How Options Are Generated |
|-----------|--------------------------|
| **Read** | Correct pinyin + 3 random pinyin from other characters in your uploaded data |
| **Multiple Choice** | Correct meaning + 3 random meanings from other uploaded characters |
| **Writing** | Shows phrase (词组) with target character replaced by pinyin as hint - user draws the character and self-assesses |

### Character Selection During Quiz

When you start a quiz and select a character count (5, 10, 20, or 30):

1. Characters are **randomly shuffled** from your uploaded character list
2. The first N characters (based on your selection) are picked for the quiz
3. Characters appear in this random order throughout the quiz

**Note:** Currently, there is no priority system based on:
- Learning history or weak areas
- Recently added characters
- Spaced repetition algorithms

Each quiz session is a fresh random selection from all available characters.

## Troubleshooting

### Port Already in Use

If you see "Port 3000 is in use", the app will automatically use the next available port (e.g., 3001). Check the terminal output for the correct URL.

### Clear Character Data

Character data is stored in CSV files in `data/users/{username}/`. To clear a user's data:
1. Delete `data/users/{username}/characters.csv` to remove their characters
2. Delete `data/users/{username}/progress.csv` to reset their quiz progress
3. Delete the entire `data/users/{username}/` folder to remove all their data

To delete a user account:
1. Remove their entry from `data/users.csv`
2. Delete their folder `data/users/{username}/`

### Backup Your Data

To backup all user data:
1. Copy the entire `data/` folder to a safe location
2. To restore, simply copy the folder back to the project directory

To backup a specific user's data:
1. Copy `data/users/{username}/` folder

